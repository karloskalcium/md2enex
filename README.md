# md2enex
`md2enex` is a Python command-line tool that converts a directory of markdown files to an Evernote `.enex` export format, that can then be imported into Evernote. It preserves file titles, creation dates and modification dates, and most formatting.

This can be used to import notes from other tools into Evernote.

## Markdown formatting notes
This tool uses [`pandoc`](https://pandoc.org/) to convert Markdown to HTML, and then converts that HTML to [ENML](http://xml.evernote.com/pub/enml2.dtd) (stripping some tags in the process), and then embeds this into the [ENEX](http://xml.evernote.com/pub/evernote-export4.dtd) import/export format created by Evernote.

I used [`Exporter`](https://apps.apple.com/us/app/exporter/id1099120373?mt=12) to export notes from Apple Notes app, and since `Exporter` does not add newlines to Markdown, `md2enex` uses the `markdown+hard_line_breaks` option of `pandoc` to ensure proper line spacing; if your Markdown line spacing is correct in the source Markdown files you may want to remove that option in the code.

Additionally, `Exporter` adds the title of the note as a top-level header in the note itself. This is not needed in Evernote, so if the first line of a note is a `<h1>` header, it is removed.

The HTML generated by the markdown will be validated against the Evernote DTD. If validation fails, the file will be skipped. Additionally, `img` and `figure` tags will be detected and if found, the file will be skipped, as embedded media is not supported by this converter.

A warning: Evernote can be finicky about notes; I have noticed that if notes have any unknown/unsupported tags in them, they can succesfully import, and then they will disappear silently at some point (perhaps when they sync to the server?). So even though this tool tries to validate the import against the Evernote DTD, to be extra safe, check the number of notes at import, and confirm that same number of notes remains in Evernote after syncing / refreshing/closing/restarting. If notes disappear, it's probably because of some strange syntax that made its way from Markdown into the generated HTML and that Evernote doesn't accept.

## Install and run

### Clone repo
  `$ git clone https://github.com/karloskalcium/md2enex.git`

### Install pandoc
  `$ brew install pandoc`

### Create and configure virtual environment.
Make sure you have the correct version of python. [Pyenv](https://github.com/pyenv/pyenv) manages python versions.
  1. `pyenv install 3.10.6` (use version in `.python-version`)
  2. Make sure to configure your shell's environment for pyenv following instructions in step 2
    [here](https://github.com/pyenv/pyenv#basic-github-checkout).
  3. Once this is done, start a new shell and run `pyenv version` and `python --version` in the terminal from the root directory of the project, both should read `3.10.6`

### *nix / OSX
 ```
  $ make python-install
  $ source ENV/bin/activate
 ```

### Run the tool
```
  $ ./md2enex.py -d <directory> -o <output filename>
```

Note: `directory` should be a directory containing all of the .md files you want to import.
This does not currently work recursively, so all files must be in the top-level of the directory.

## Bugs, feature requests, or contributions
Open an [Issue](https://github.com/karloskalcium/md2enex/issues). Pull requests welcome.

## Other tools
* https://github.com/akosbalasko/yarle  "Yarle - The ultimate converter of Evernote notes to Markdown"
* https://github.com/wormi4ok/evernote2md "Convert Evernote .enex files to Markdown"
